 ```mermaid
 graph TD
    subgraph "外部からの呼び出し (Entry Points)"
        A["<b>UIメニュー実行</b><br>(rebuildSummarySheet)"]
        B["<b>シート手動編集</b><br>(updateSummarySheet)"]
        C["<b>WebApp/バッチ処理</b><br>(updateSummaryAndForm)"]
    end

    subgraph "03_BusinessLogic_Summary.js 内の処理フロー"
        D[rebuildSummarySheet<br><b>(全再構築)</b>]
        E[updateSummarySheet<br><b>(部分更新トリガー)</b>]
        F[updateSummaryAndForm<br><b>(統合更新)</b>]
        G[recalculateAndWriteSummary<br><b>(部分更新コア)</b>]
        H["_getReservationCountsForDate<br>(予約数を集計)"]
        I["_createSummaryRowData<br>(空席を計算し、行データを生成)"]
        J["_calculateTokyoAvailability<br>(東京教室の特殊な空席計算)"]
        K["updateSummaryRow<br>(シートへ書き込み)"]
        L["getVenueForDate<br>(会場名を取得)"]
    end

    subgraph "外部ファイルへの依存"
        M["<b>06_ExternalServices.js</b><br>setCheckboxChoices()"]
    end

    A --> D
    B --> E
    C --> F

    F --> G
    F --> M

    E --> G

    G --> H
    G --> L
    G --> I
    I --> J
    G --> K

    D -- "集計した全データ" --> I
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B fill:#f9f,stroke:#333,stroke-width:2px
    style C fill:#f9f,stroke:#333,stroke-width:2px
    
    style D fill:#cff,stroke:#333,stroke-width:2px
    style E fill:#cff,stroke:#333,stroke-width:2px
    style F fill:#cff,stroke:#333,stroke-width:2px
// [MermaidChart: 1d2f4976-3301-4ab0-9522-ba66a61c414e]
// [MermaidChart: 1d2f4976-3301-4ab0-9522-ba66a61c414e]
// [MermaidChart: 1d2f4976-3301-4ab0-9522-ba66a61c414e]
// [MermaidChart: 1d2f4976-3301-4ab0-9522-ba66a61c414e]
// [MermaidChart: 1d2f4976-3301-4ab0-9522-ba66a61c414e]

```
