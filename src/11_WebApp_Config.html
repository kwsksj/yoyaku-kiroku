<script>
  /**
   * =================================================================
   * 【ファイル名】: 11_WebApp_Config.html
   * 【バージョン】: 1.7
   * 【役割】: WebAppのフロントエンドで使用される設定とスタイル定義
   * 【構成】: 14ファイル構成のうちの11番目
   * 【v1.7での変更点】:
   * - 全体的な配色をよりエネルギッシュで温かみのあるテーマに更新
   * - ボタンのテキストの可読性を向上
   * - 会計ボタンに黄色系の配色を適用
   * - 記録カードに背景色を追加
   * =================================================================
   */

  // =================================================================
  // 1. APPLICATION CONSTANTS（統一定数システム）
  // =================================================================

  // 【重要】統一定数は getAppInitialData() で取得される constants オブジェクトを使用
  // バックエンドの 00_Constants.js で定義された統一定数がフロントエンドに配信される
  //
  // 使用例:
  // - stateManager.getState().constants.classrooms.TOKYO （'東京教室'）
  // - stateManager.getState().constants.headers.STUDENT_ID （'生徒ID'）
  // - STATUS.WAITING （'waiting'）
  // - stateManager.getState().constants.sessions.MORNING （'午前'）
  // - BANK.NAME （'ゆうちょ銀行'）
  // - stateManager.getState().constants.frontendUi.DISCOUNT_OPTIONS.THIRTY_MIN （30）
  //
  // 注意: このファイルでは、バックエンド定数との重複を避けるため
  // フロントエンド固有の定数のみ定義する

  // --- フロントエンド専用定数（統一定数システムに移行済み） ---

  // 【移行完了】以下の定数は 00_Constants.js に移行し、constants オブジェクトでアクセス可能
  // - ITEM_NAME_DISCOUNT → stateManager.getState().constants.items.DISCOUNT
  // - SESSION_MORNING/AFTERNOON/ALL_DAY → stateManager.getState().constants.sessions.MORNING/AFTERNOON/ALL_DAY
  // - UNIT_CM3 → stateManager.getState().constants.units.CM3
  // - PAYMENT.* → stateManager.getState().constants.paymentDisplay.*
  // - BANK_* → BANK.*
  // - DISCOUNT_OPTION_* → stateManager.getState().constants.frontendUi.DISCOUNT_OPTIONS.*
  // - TIME_STEP_MINUTES → stateManager.getState().constants.frontendUi.TIME_SETTINGS.STEP_MINUTES
  // - TIME_END_BUFFER_HOURS → stateManager.getState().constants.frontendUi.TIME_SETTINGS.END_BUFFER_HOURS

  // 【互換性】既存コードとの互換性のため、必要に応じて個別定数も利用可能
  // 例: const SESSION_MORNING = stateManager.getState().constants.sessions.MORNING;

  // 【純粋にフロントエンド専用】以下は本当にフロントエンドでしか使わない定数のみ
  // 現在、純粋にフロントエンド専用の定数はありません

  // =================================================================
  // 2. DESIGN CONFIGURATION
  // =================================================================
  const DesignConfig = {
    // テキストや背景の色設定（温かみと活気のある配色）
    colors: {
      text: 'text-brand-text', // メインテキスト
      textSubtle: 'text-brand-subtle', // サブテキスト
      textMuted: 'text-brand-muted', // 薄いテキスト
      primary:
        'bg-action-primary-bg text-action-primary-text active:bg-action-primary-hover', // プライマリ (テラコッタ)
      secondary:
        'bg-action-secondary-bg text-action-secondary-text active:bg-action-secondary-hover', // セカンダリ (明るいベージュ)
      attention:
        'bg-action-attention-bg text-action-attention-text active:bg-action-attention-hover', // 注意 (若葉色)
      accounting:
        'bg-action-accounting-bg text-action-accounting-text active:bg-action-accounting-hover', // 会計 (アンバー)
      danger:
        'bg-state-danger-bg text-state-danger-text active:bg-state-danger-hover', // 危険 (落ち着いた赤)
      success:
        'bg-state-success-bg text-state-success-text active:bg-state-success-hover', // 成功 (若葉色)
      paid: 'bg-action-paid-bg text-action-paid-text', // 支払い済み (薄い緑)
      info: 'bg-ui-surface text-brand-text border border-ui-border',
      warning:
        'bg-ui-warning-bg text-ui-warning-text border border-ui-warning-border',
      error: 'bg-ui-error-bg text-ui-error-text border border-ui-error-border',
    },

    // ボタンの基本スタイル
    buttons: {
      base: 'font-bold py-2.5 px-5 rounded-md transition-all duration-150 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-offset-2 mobile-button touch-friendly',
      full: 'w-[250px] mx-auto block',
      auto: 'w-auto',
      primary:
        'font-bold py-2.5 px-5 rounded-md transition-all duration-150 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-offset-2 mobile-button touch-friendly bg-action-primary-bg text-action-primary-text active:bg-action-primary-hover',
      secondary:
        'font-bold py-2.5 px-5 rounded-md transition-all duration-150 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-offset-2 mobile-button touch-friendly bg-action-secondary-bg text-action-secondary-text active:bg-action-secondary-hover',
      attention:
        'font-bold py-2.5 px-5 rounded-md transition-all duration-150 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-offset-2 mobile-button touch-friendly bg-action-attention-bg text-action-attention-text active:bg-action-attention-hover',
      accounting:
        'font-bold py-2.5 px-5 rounded-md transition-all duration-150 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-offset-2 mobile-button touch-friendly bg-action-accounting-bg text-action-accounting-text active:bg-action-accounting-hover',
    },

    // テキストスタイル設定
    text: {
      heading: 'text-xl font-bold text-brand-text',
      subheading: 'text-lg font-medium text-brand-text',
      body: 'text-base text-brand-text',
      bodySubtle: 'text-base text-brand-subtle',
      caption: 'text-sm text-brand-subtle',
      label: 'text-base font-bold text-brand-text',
      labelBlock: 'block text-brand-text text-base font-bold mb-2',
    },

    // レイアウトユーティリティ
    layout: {
      container: 'max-w-screen-sm mx-auto p-4',
      containerNoPadding: 'max-w-screen-sm mx-auto',
      section: 'mb-8',
      card: 'shadow-card rounded-lg border border-solid border-card-border',
      centerContent: 'flex items-center justify-center',
      spaceBetween: 'flex items-center justify-between',
    },

    // ユーティリティクラス
    utils: {
      hidden: 'hidden',
      loading: 'opacity-50 pointer-events-none',
      mobileFriendly: 'mobile-button touch-friendly',
      flexCenter: 'flex items-center justify-center',
      flexBetween: 'flex items-center justify-between',
      fullWidth: 'w-full',
      autoMargin: 'mx-auto',
    },

    // カードスタイル
    cards: {
      base: 'w-full text-left p-3 rounded-lg mobile-card touch-friendly transition-all duration-150',
      container: 'max-w-md mx-auto space-y-3',
      background: 'bg-ui-surface border border-ui-border',
      state: {
        available: {
          card: 'bg-state-available-bg border border-state-available-border mobile-card active:bg-state-success-hover',
          text: 'text-state-available-text',
        },
        waitlist: {
          card: 'bg-state-waitlist-bg border border-state-waitlist-border mobile-card',
          text: 'text-state-waitlist-text',
        },
        booked: {
          card: 'bg-state-booked-bg border border-state-booked-border mobile-card',
          text: 'text-state-booked-text',
        },
        history: {
          card: 'bg-brand-light border border-ui-border mobile-card',
        },
      },
    },

    // 入力フォームのスタイル
    inputs: {
      container: 'max-w-md mx-auto',
      base: 'text-lg w-full p-3 border border-ui-border rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-text mobile-input touch-friendly bg-ui-input focus:bg-ui-input-focus transition-all duration-150',
      textarea:
        'text-lg w-full p-3 border border-ui-border rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-text h-24 mobile-input bg-ui-input focus:bg-ui-input-focus transition-all duration-150',
    },
  };

  // =================================================================
  // 3. CSS STYLES SETUP
  // =================================================================
  const addCustomStyles = () => {
    const style = document.createElement('style');
    style.textContent = `
      /* ========== CSS Variables ========== */
      :root {
        /* Energetic and warm theme for a wood carving school */
        --brand-text: #4E342E;       /* Dark Brown for high readability */
        --brand-subtle: #785A4E;     /* Medium Brown for sub-text */
        --brand-muted: #A1887F;      /* Lighter, soft brown */
        --brand-bg: #FFFDF5;         /* Warm, very light cream background */
        --brand-surface: #FFFFFF;    /* White for card backgrounds for a clean look */
        --brand-light: #F5F1ED;      /* Light, warm beige for hover states */

        --action-primary: #C86F34;   /* Energetic terracotta for main actions */
        --action-secondary: #E4CDBA; /* Light, warm beige for secondary actions */
        --action-attention: #5A8C36; /* Lively, fresh green for attention */
        --action-accounting: #F59E0B;/* Bright amber for accounting actions */
        --action-danger: #B91C1C;    /* A clear, strong red for danger */

        --state-available: #5A8C36;  /* Lively green for available slots */
        --state-waitlist: #F59E0B;   /* Bright amber for waitlist */
        --state-booked: #785A4E;     /* Medium brown for booked slots */

        --ui-border: #E4CDBA;        /* Soft, warm beige for borders */
        --ui-input: #FAFAFA;         /* Neutral light gray for inputs */
        --ui-surface: #FFFFFF;

        --modal-overlay: rgba(0, 0, 0, 0.5);
        --spinner-border: #f3f4f6;
      }

      /* ========== Base Styles ========== */
      body {
        font-family: 'Zen Kaku Gothic New', sans-serif;
        color: var(--brand-text);
        background-color: var(--brand-bg);
        line-height: 1.6;
      }

      /* ========== Mobile-Friendly Components ========== */
      .mobile-button, .mobile-input, .mobile-card {
        min-height: 48px;
      }
      .touch-friendly {
        touch-action: manipulation;
      }

      /* ========== Animations ========== */
      .fade-in { animation: fadeInUp 0.3s ease-out; }
      @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .spinner {
        border: 4px solid var(--spinner-border);
        width: 32px;
        height: 32px;
        border-radius: 50%;
        border-left-color: var(--brand-text);
        animation: spin 1s linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg); } }

      /* ========== Layout Components ========== */
      #loading { z-index: 100; }
      .modal-overlay {
        position: fixed; inset: 0; background-color: var(--modal-overlay);
        display: flex; align-items: center; justify-content: center;
        z-index: 50; opacity: 0; transition: opacity 0.3s ease;
        pointer-events: none; backdrop-filter: blur(3px);
      }
      .modal-overlay.active { opacity: 1; pointer-events: auto; }
      #custom-modal {
        opacity: 0; transition: opacity 0.3s ease; pointer-events: none;
      }
      #custom-modal.active { opacity: 1; pointer-events: auto; }
      .modal-content {
        background: white; padding: 1.5rem; border-radius: 0.75rem;
        width: 90%; max-width: 400px; text-align: center;
        max-height: 85vh; overflow-y: auto;
      }
      .modal-content p { margin-bottom: 1.25rem; }
      .modal-content .modal-buttons { justify-content: center; }

      /* ========== Custom Components ========== */
      details > summary { list-style: none; cursor: pointer; }
      details > summary::-webkit-details-marker { display: none; }

      .accounting-item, .reservation-card {
        background-color: var(--brand-surface);
        border: 1px solid var(--ui-border);
        transition: all 0.2s ease;
      }
      .accounting-item:hover, .reservation-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        border-color: var(--brand-muted);
      }

      /* ========== Responsive Design ========== */
      @media (max-width: 640px) {
        .modal-content { width: 95%; padding: 1rem; }
        .mobile-button, .mobile-input { font-size: 16px; }
      }
    `;
    document.head.appendChild(style);
  };

  // =================================================================
  // 4. TAILWIND CSS SETUP
  // =================================================================
  // 注意: CDN版Tailwindは本番環境では推奨されませんが、Google Apps Script環境では
  // PostCSS pluginやTailwind CLIの利用が困難なため、CDN版を使用しています。
  const setupTailwindCSS = () => {
    const tailwindScript = document.createElement('script');
    tailwindScript.src = 'https://cdn.tailwindcss.com';

    tailwindScript.onload = function () {
      if (window.tailwind) {
        window.tailwind.config = {
          theme: {
            extend: {
              fontSize: { '2xs': '0.625rem' },
              fontFamily: { sans: ['Zen Kaku Gothic New', 'sans-serif'] },
              colors: {
                brand: {
                  bg: '#FFFDF5',
                  surface: '#FFFFFF',
                  text: '#4E342E',
                  subtle: '#785A4E',
                  light: '#F5F1ED',
                  dark: '#4E342E',
                  muted: '#A1887F',
                },
                action: {
                  'primary-bg': '#C86F34',
                  'primary-text': '#FFFFFF',
                  'primary-hover': '#A95B2A',
                  'secondary-bg': '#E4CDBA',
                  'secondary-text': '#4E342E', // Improved contrast
                  'secondary-hover': '#D7BCA9',
                  'attention-bg': '#5A8C36',
                  'attention-text': '#FFFFFF',
                  'attention-hover': '#4A732C',
                  'accounting-bg': '#F59E0B', // Amber
                  'accounting-text': '#4E342E', // Dark text for readability
                  'accounting-hover': '#D97706',
                  'danger-bg': '#B91C1C',
                  'danger-text': '#FFFFFF',
                  'danger-hover': '#991B1B',
                  'paid-bg': '#F0FDF4',
                  'paid-text': '#166534',
                },
                state: {
                  'available-text': '#166534',
                  'available-bg': '#F0FDF4',
                  'available-border': '#A7F3D0',
                  'available-hover': '#D1FAE5',
                  'waitlist-text': '#B45309',
                  'waitlist-bg': '#FFFBEB',
                  'waitlist-border': '#FDE68A',
                  'booked-text': '#44403C',
                  'booked-bg': '#F5F5F4',
                  'booked-border': '#E7E5E4',
                  'success-bg': '#F0FDF4',
                  'success-text': '#166534',
                  'success-border': '#A7F3D0',
                  'success-hover': '#D1FAE5',
                  'danger-bg': '#FEF2F2',
                  'danger-text': '#B91C1C',
                  'danger-border': '#FECACA',
                  'danger-hover': '#FEE2E2',
                },
                ui: {
                  border: '#E4CDBA',
                  'border-light': '#F5F1ED',
                  surface: '#FFFFFF',
                  input: '#FAFAFA',
                  'input-focus': '#FFFFFF',
                  'error-text': '#B91C1C',
                  'error-bg': '#FEF2F2',
                  'error-border': '#FECACA',
                  'warning-text': '#B45309',
                  'warning-bg': '#FFFBEB',
                  'warning-border': '#FDE68A',
                  'link-text': '#0369A1',
                  'weekend-sunday': '#B91C1C',
                  'weekend-saturday': '#0369A1',
                },
              },
            },
          },
        };
      }
    };

    tailwindScript.onerror = function () {
      console.warn('[CONFIG] Tailwind CSS読み込みに失敗しました');
    };

    document.head.appendChild(tailwindScript);
  };

  // =================================================================
  // 5. INITIALIZATION
  // =================================================================
  addCustomStyles();
  setupTailwindCSS();
</script>
