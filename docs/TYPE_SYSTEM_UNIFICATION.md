# å‹ã‚·ã‚¹ãƒ†ãƒ çµ±ä¸€è¨ˆç”»

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0 **ä½œæˆæ—¥**: 2025-10-03 **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¨ˆç”»ä¸­

---

## ğŸ“‹ ç›®æ¬¡

1. [èƒŒæ™¯ã¨å•é¡Œç‚¹](#èƒŒæ™¯ã¨å•é¡Œç‚¹)
2. [ç¾çŠ¶åˆ†æ](#ç¾çŠ¶åˆ†æ)
3. [çµ±ä¸€è¨­è¨ˆæ–¹é‡](#çµ±ä¸€è¨­è¨ˆæ–¹é‡)
4. [å®Ÿè£…è¨ˆç”»](#å®Ÿè£…è¨ˆç”»)
5. [ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ](#ãƒ¡ãƒªãƒƒãƒˆãƒ‡ãƒ¡ãƒªãƒƒãƒˆ)
6. [AIé§†å‹•é–‹ç™ºã«ãŠã‘ã‚‹å‹ç®¡ç†](#aié§†å‹•é–‹ç™ºã«ãŠã‘ã‚‹å‹ç®¡ç†)
7. [ä»Šå¾Œã®é‹ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](#ä»Šå¾Œã®é‹ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³)

---

## èƒŒæ™¯ã¨å•é¡Œç‚¹

### å•é¡Œã®æ¦‚è¦

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã„ã¦ã€äºˆç´„ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ä¼šè¨ˆé–¢é€£ã®ãƒ‡ãƒ¼ã‚¿å‹ãŒ**è¤‡æ•°ã®ç•°ãªã‚‹å®šç¾©ã§é‡è¤‡**ã—ã¦ãŠã‚Šã€ä»¥ä¸‹ã®æ·±åˆ»ãªå•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ï¼š

- **å‹ã®é‡è¤‡**: åŒã˜æ¦‚å¿µã‚’è¡¨ã™å‹ãŒ5ç¨®é¡ä»¥ä¸Šå­˜åœ¨
- **å‹å®‰å…¨æ€§ã®å´©å£Š**: `any`, `[key: string]: unknown` ã®ä¹±ç”¨
- **ä¿å®ˆæ€§ã®ä½ä¸‹**: å‹å®šç¾©ãŒæ•£åœ¨ã—ã€å¤‰æ›´ãŒå›°é›£
- **ãƒã‚°ã®æ¸©åºŠ**: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã®ä¸ä¸€è‡´ã‚„null/undefinedå‡¦ç†ã®ä¸çµ±ä¸€

### ç™ºç”ŸåŸå› 

**AIé§†å‹•é–‹ç™ºã®å…¸å‹çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³**:

1. **ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä¸è¶³ã«ã‚ˆã‚‹é‡è¤‡ä½œæˆ**: AIã¯æ—¢å­˜ã®å‹ã‚’è¦‹è½ã¨ã—ã¦æ–°è¦ä½œæˆ
2. **å±€æ‰€æœ€é©åŒ–**: ã€Œã“ã®é–¢æ•°ã ã‘å‹•ã‘ã°è‰¯ã„ã€ã¨ã„ã†çŸ­æœŸçš„ãªè¦–ç‚¹
3. **å¿œæ€¥å‡¦ç½®ã®ç©ã¿é‡ã­**: å‹ã‚¨ãƒ©ãƒ¼ã‚’`any`ã§ã€Œã¨ã‚Šã‚ãˆãšæ¶ˆã™ã€
4. **å‘½åã®æºã‚Œ**: åŒã˜æ¦‚å¿µã«å¯¾ã™ã‚‹ç•°ãªã‚‹å‘½åãƒ‘ã‚¿ãƒ¼ãƒ³

**äººé–“é–‹ç™ºã§ã‚‚é¡ä¼¼ã®å•é¡Œã¯ç™ºç”Ÿã™ã‚‹ãŒ**:

- ç™ºç”Ÿé€Ÿåº¦ãŒé…ã„ï¼ˆæ•°ãƒ¶æœˆã€œå¹´å˜ä½ï¼‰
- ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æ°—ã¥ãæ©Ÿä¼šãŒã‚ã‚‹
- ãƒãƒ¼ãƒ é–“ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³ãŒä¸»å› 

---

## ç¾çŠ¶åˆ†æ

### 1. äºˆç´„é–¢é€£å‹ã®é‡è¤‡ï¼ˆ5ç¨®é¡ï¼‰

#### é‡è¤‡ã™ã‚‹å‹å®šç¾©

| å‹å                   | å®šç¾©å ´æ‰€              | ç”¨é€”                                 | å•é¡Œç‚¹                 |
| ---------------------- | --------------------- | ------------------------------------ | ---------------------- |
| `ReservationArrayData` | gas-environment.d.ts  | Sheetsç”Ÿãƒ‡ãƒ¼ã‚¿ï¼ˆé…åˆ—ï¼‰               | ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã®é…åˆ—   |
| `RawReservationObject` | gas-environment.d.ts  | Sheetsç”Ÿãƒ‡ãƒ¼ã‚¿ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–ç›´å¾Œï¼‰ | å…¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£optional   |
| `ReservationObject`    | gas-environment.d.ts  | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å†…éƒ¨å‡¦ç†ç”¨               | æ­£è¦åŒ–æ¸ˆã¿ã ãŒé™å®šçš„   |
| `Reservation`          | api-types.d.ts        | APIé€šä¿¡ç”¨                            | ã‚·ãƒ³ãƒ—ãƒ«ã™ãã¦æƒ…å ±ä¸è¶³ |
| `ReservationData`      | html-environment.d.ts | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨                     | å‹•çš„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤šæ•°     |

#### ã‚³ãƒ¼ãƒ‰ä¾‹

```typescript
// api-types.d.ts
interface Reservation {
  reservationId: string;
  studentId: string;
  date: string | Date;
  classroom: string;
  startTime?: string;
  endTime?: string;
  status: string;
  firstLecture?: boolean;
}

// html-environment.d.ts
interface ReservationData {
  reservationId: string;
  classroom: string;
  date: string;
  venue?: string;
  startTime?: string;
  endTime?: string;
  status?: string;
  studentId?: string;
  // ... 20å€‹ä»¥ä¸Šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
  [key: `material${string}`]: string | number | undefined;
  [key: `otherSales${string}`]: string | number | undefined;
}
```

#### å¼Šå®³

- ğŸ”„ ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œã”ã¨ã«é »ç¹ãªå‹å¤‰æ›ãŒå¿…è¦
- âš ï¸ å‹ã‚­ãƒ£ã‚¹ãƒˆã®å¤šç”¨ã«ã‚ˆã‚Šå‹ãƒã‚§ãƒƒã‚¯ãŒæ©Ÿèƒ½ã—ãªã„
- ğŸ› ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã®ä¸ä¸€è‡´ï¼ˆ`message` vs `messageToTeacher`ï¼‰
- ğŸ“ˆ åŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ã™è¤‡æ•°ã®å‹å®šç¾©ã‚’ç¶­æŒã™ã‚‹è² æ‹…

---

### 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£å‹ã®é‡è¤‡ï¼ˆ5ç¨®é¡ä»¥ä¸Šï¼‰

#### é‡è¤‡ã™ã‚‹å‹å®šç¾©

| å‹å                      | å®šç¾©å ´æ‰€              | ç”¨é€”                 | å•é¡Œç‚¹                   |
| ------------------------- | --------------------- | -------------------- | ------------------------ |
| `UserInfo`                | api-types.d.ts        | APIé€šä¿¡ç”¨ï¼ˆæœ€å°é™ï¼‰  | ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ3ã¤ã®ã¿      |
| `UserData`                | html-environment.d.ts | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨     | 10å€‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£         |
| `UserProfileUpdate`       | api-types.d.ts        | æ›´æ–°ç”¨ï¼ˆå…¨optionalï¼‰ | 20å€‹ä»¥ä¸Šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£     |
| `UserDetailForEdit`       | api-types.d.ts        | ç·¨é›†ç”¨ï¼ˆå…¨requiredï¼‰ | å¿…é ˆ/ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒä¸çµ±ä¸€  |
| `NewUserRegistration`     | api-types.d.ts        | æ–°è¦ç™»éŒ²ç”¨           | 16å€‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£         |
| `UserProfileUpdateResult` | gas-environment.d.ts  | æ›´æ–°çµæœç”¨           | `[key: string]: unknown` |

#### ã‚³ãƒ¼ãƒ‰ä¾‹

```typescript
// api-types.d.ts
interface UserInfo {
  studentId: string;
  displayName: string;
  realName: string;
}

interface UserProfileUpdate {
  studentId?: string;
  displayName?: string;
  phone?: string;
  realName?: string;
  nickname?: string;
  email?: string;
  // ... 20å€‹ä»¥ä¸Šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆå…¨ã¦optionalï¼‰
}

interface UserDetailForEdit {
  studentId: string;
  realName: string;
  nickname: string;
  phone: string;
  email: string;
  // ... 12å€‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆå…¨ã¦å¿…é ˆï¼‰
}

// gas-environment.d.ts
interface UserProfileUpdateResult {
  updatedUser: {
    studentId: string;
    displayName: string;
    realName: string;
    phone: string;
    [key: string]: unknown; // å‹å®‰å…¨æ€§ã®å´©å£Š
  };
}
```

#### å¼Šå®³

- ğŸ”€ åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ãªã®ã«5ç¨®é¡ã®å‹ã‚’ä½¿ã„åˆ†ã‘ã‚‹æ··ä¹±
- âš ï¸ å¿…é ˆ/ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ä¸çµ±ä¸€ï¼ˆ`nickname?: string` vs `nickname: string`ï¼‰
- ğŸš« `[key: string]: unknown` ã«ã‚ˆã‚‹å‹å®‰å…¨æ€§ã®å®Œå…¨å–ªå¤±
- ğŸ“ ã©ã®å‹ã‚’ä½¿ã†ã¹ãã‹åˆ¤æ–­ã«è¿·ã†

---

### 3. ä¼šè¨ˆé–¢é€£å‹ã®é‡è¤‡ï¼ˆ5ç¨®é¡ä»¥ä¸Šï¼‰

#### é‡è¤‡ã™ã‚‹å‹å®šç¾©

| å‹å                          | å®šç¾©å ´æ‰€              | ç”¨é€”                 | å•é¡Œç‚¹                   |
| ----------------------------- | --------------------- | -------------------- | ------------------------ |
| `AccountingDetailsPayload`    | api-types.d.ts        | APIé€ä¿¡ç”¨            | æ§‹é€ ãŒè¤‡é›‘               |
| `AccountingUserInput`         | api-types.d.ts        | ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›         | æ˜ç¢ºãªæ§‹é€                |
| `AccountingDetails`           | api-types.d.ts        | è¨ˆç®—çµæœ             | -                        |
| `AccountingCalculationResult` | accounting.d.ts       | è¨ˆç®—çµæœï¼ˆé‡è¤‡ï¼‰     | å®Œå…¨ã«é‡è¤‡               |
| `AccountingFormData`          | accounting.d.ts       | ãƒ•ã‚©ãƒ¼ãƒ ç”¨           | `breakTime: number`      |
| `AccountingFormData`          | html-environment.d.ts | ãƒ•ã‚©ãƒ¼ãƒ ç”¨ï¼ˆé‡è¤‡ï¼‰   | `breakTime: string`      |
| `AccountingPayload`           | accounting.d.ts       | é€ä¿¡ç”¨               | `userInput: any`         |
| `AccountingPayload`           | gas-environment.d.ts  | é€ä¿¡ç”¨ï¼ˆé‡è¤‡ï¼‰       | `[key: string]: unknown` |
| `AccountingSubmissionPayload` | html-environment.d.ts | é€ä¿¡ç”¨ï¼ˆã•ã‚‰ã«é‡è¤‡ï¼‰ | è©³ç´°æ§‹é€                  |

#### ã‚³ãƒ¼ãƒ‰ä¾‹

```typescript
// api-types.d.ts
interface AccountingDetails {
  tuition: {
    items: Array<{ name: string; price: number }>;
    subtotal: number;
  };
  sales: {
    items: Array<{ name: string; price: number }>;
    subtotal: number;
  };
  grandTotal: number;
  paymentMethod: string;
}

// accounting.d.ts - å®Œå…¨ã«é‡è¤‡
interface AccountingCalculationResult {
  tuition: {
    items: Array<{ name: string; price: number }>;
    subtotal: number;
  };
  sales: {
    items: Array<{ name: string; price: number }>;
    subtotal: number;
  };
  grandTotal: number;
  paymentMethod: string;
}

// accounting.d.ts
interface AccountingFormData {
  breakTime?: number; // â† number
  // ...
}

// html-environment.d.ts - åŒåã ãŒç•°ãªã‚‹å®šç¾©
interface AccountingFormData {
  breakTime?: string; // â† string
  // ...
  [key: string]: any; // å‹å®‰å…¨æ€§ã®å´©å£Š
}

// accounting.d.ts
interface AccountingPayload {
  reservationId: string;
  classroom: string;
  studentId: string;
  userInput: any; // â† å‹å®‰å…¨æ€§ã‚¼ãƒ­
  updateStatus?: boolean;
}

// gas-environment.d.ts - ã•ã‚‰ã«åˆ¥å®šç¾©
interface AccountingPayload {
  studentId: string;
  reservationId?: string;
  classroom?: string;
  userInput?: Record<string, unknown>;
  [key: string]: unknown; // å±é™º
}
```

#### å¼Šå®³

- ğŸ” **å®Œå…¨é‡è¤‡**: `AccountingDetails` â‰’ `AccountingCalculationResult`
- âš ï¸ **åŒåç•°å‹**: `AccountingFormData` ãŒ2ç®‡æ‰€ã§ç•°ãªã‚‹å®šç¾©ï¼ˆ`breakTime`ã®å‹ãŒé•ã†ï¼‰
- ğŸš« **å‹å®‰å…¨æ€§ã®å´©å£Š**: `userInput: any`, `[key: string]: unknown`
- ğŸ“ **3é‡ã®é‡è¤‡**: `AccountingPayload` ãŒ3ç®‡æ‰€ã§ç•°ãªã‚‹å®šç¾©

---

### 4. ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†å‹ã®é‡è¤‡ï¼ˆ3ç¨®é¡ï¼‰

```typescript
// api-types.d.ts
interface CancelReservationInfo {
  reservationId: string;
  classroom: string;
  studentId: string;
  cancelMessage?: string;
}

// gas-environment.d.ts
interface CancelInfo {
  studentId: string;
  [key: string]: unknown; // æ¥µã‚ã¦ç·©ã„å‹
}

// html-environment.d.ts
interface CancelReservationData extends ActionHandlerData {
  reservationId: string;
  classroom: string;
  date: string; // â† api-types.d.tsã«ã¯ãªã„
  studentId: string;
  cancelMessage?: string;
}
```

---

## çµ±ä¸€è¨­è¨ˆæ–¹é‡

### è¨­è¨ˆå“²å­¦ï¼šãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆ (DDD)

```
Core Domain Models (ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³å‹)
  â†“ ç¶™æ‰¿ãƒ»æ‹¡å¼µ
Operation-Specific DTOs (æ“ä½œåˆ¥ãƒ‡ãƒ¼ã‚¿è»¢é€å‹)
```

### å‹ã®3å±¤æ§‹é€ 

```
[Layer 1] RawSheetData (é…åˆ—)
    â†“ å¤‰æ›1å›ã®ã¿
[Layer 2] Coreå‹ (çµ±ä¸€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ) â† å…¨å‡¦ç†ã§ã“ã‚Œã‚’ä½¿ç”¨
    â†“ å¿…è¦ã«å¿œã˜ã¦
[Layer 3] DTOå‹ (æ“ä½œåˆ¥ç‰¹åŒ–å‹)
```

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
types/
â”œâ”€â”€ core/                    # Coreå‹å®šç¾©ï¼ˆLayer 2ï¼‰
â”‚   â”œâ”€â”€ reservation-core.d.ts
â”‚   â”œâ”€â”€ user-core.d.ts
â”‚   â”œâ”€â”€ accounting-core.d.ts
â”‚   â””â”€â”€ index.d.ts
â”œâ”€â”€ dto/                     # DTOå‹å®šç¾©ï¼ˆLayer 3ï¼‰
â”‚   â”œâ”€â”€ reservation-dto.d.ts
â”‚   â”œâ”€â”€ user-dto.d.ts
â”‚   â”œâ”€â”€ accounting-dto.d.ts
â”‚   â””â”€â”€ index.d.ts
â”œâ”€â”€ gas-environment.d.ts     # GASç’°å¢ƒå‹ï¼ˆLayer 1ã‚’å«ã‚€ï¼‰
â”œâ”€â”€ html-environment.d.ts    # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç’°å¢ƒå‹
â””â”€â”€ api-types.d.ts           # æ—¢å­˜APIå‹ï¼ˆæ®µéšçš„ã«å»ƒæ­¢ï¼‰
```

---

## çµ±ä¸€å‹å®šç¾©

### 1. äºˆç´„é–¢é€£å‹

#### Coreå‹

```typescript
/**
 * äºˆç´„ãƒ‡ãƒ¼ã‚¿ã®çµ±ä¸€ã‚³ã‚¢å‹
 * - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ»ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å…±é€š
 * - å…¨å‡¦ç†ã§ã“ã®å‹ã‚’ä½¿ç”¨ã™ã‚‹
 */
interface ReservationCore {
  // === å¿…é ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ ===
  reservationId: string;
  studentId: string;
  classroom: string;
  date: string; // YYYY-MM-DD
  status: string; // CONSTANTS.STATUSã®å€¤

  // === åŸºæœ¬ã‚ªãƒ—ã‚·ãƒ§ãƒ³ ===
  venue?: string;
  startTime?: string; // HH:mm
  endTime?: string; // HH:mm

  // === äºˆç´„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ ===
  chiselRental?: boolean;
  firstLecture?: boolean;
  workInProgress?: string;
  materialInfo?: string;
  order?: string;
  messageToTeacher?: string;

  // === ä¼šè¨ˆé–¢é€£ ===
  accountingDetails?: AccountingDetailsCore | null;
  discountApplied?: boolean | string;
  è¨ˆç®—æ™‚é–“?: number;
  breakTime?: number;

  // === å‹•çš„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆmaterial/otherSalesç³»ï¼‰ ===
  [key: `material${string}`]: string | number | undefined;
  [key: `otherSales${string}`]: string | number | undefined;
}
```

#### DTOå‹

```typescript
/** Sheetsç”Ÿãƒ‡ãƒ¼ã‚¿ï¼ˆå¤‰æ›å‰ï¼‰ */
type RawSheetRow = Array<string | Date | boolean | number | null>;

/** äºˆç´„ä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆIDãªã—ï¼‰ */
interface ReservationCreateDto extends Omit<ReservationCore, 'reservationId' | 'status'> {
  user: UserInfoDto;
}

/** äºˆç´„æ›´æ–°ãƒªã‚¯ã‚¨ã‚¹ãƒˆ */
interface ReservationUpdateDto extends Pick<ReservationCore, 'reservationId' | 'classroom' | 'studentId' | 'startTime' | 'endTime' | 'chiselRental' | 'firstLecture' | 'workInProgress' | 'materialInfo' | 'order' | 'messageToTeacher'> {}

/** äºˆç´„ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ */
interface ReservationCancelDto {
  reservationId: string;
  classroom: string;
  studentId: string;
  date: string; // æ¤œè¨¼ç”¨
  cancelMessage?: string;
}

/** APIå¿œç­”ç”¨ï¼ˆè»½é‡ç‰ˆï¼‰ */
type ReservationApiDto = Pick<ReservationCore, 'reservationId' | 'studentId' | 'classroom' | 'date' | 'status' | 'venue' | 'startTime' | 'endTime' | 'chiselRental' | 'firstLecture'>;
```

#### å¤‰æ›é–¢æ•°

```typescript
/**
 * Sheetsç”Ÿãƒ‡ãƒ¼ã‚¿ â†’ ReservationCore ã«å¤‰æ›ï¼ˆ1ç®‡æ‰€ã®ã¿ï¼‰
 */
function convertRowToReservation(row: RawSheetRow, headerMap: HeaderMapType): ReservationCore {
  return {
    reservationId: row[headerMap['äºˆç´„ID']] || '',
    studentId: row[headerMap['ç”Ÿå¾’ID']] || '',
    classroom: row[headerMap['æ•™å®¤']] || '',
    date: formatDate(row[headerMap['æ—¥ä»˜']]),
    status: row[headerMap['ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹']] || '',
    venue: row[headerMap['ä¼šå ´']] || undefined,
    startTime: formatTime(row[headerMap['é–‹å§‹æ™‚åˆ»']]),
    endTime: formatTime(row[headerMap['çµ‚äº†æ™‚åˆ»']]),
    chiselRental: Boolean(row[headerMap['å½«åˆ»åˆ€ãƒ¬ãƒ³ã‚¿ãƒ«']]),
    firstLecture: Boolean(row[headerMap['åˆå›è¬›åº§']]),
    workInProgress: row[headerMap['åˆ¶ä½œãƒ¡ãƒ¢']] || undefined,
    materialInfo: row[headerMap['ææ–™æƒ…å ±']] || undefined,
    order: row[headerMap['æ³¨æ–‡']] || undefined,
    messageToTeacher: row[headerMap['å…ˆç”Ÿã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸']] || undefined,
    // ... ãã®ä»–ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
  };
}

/**
 * ReservationCore â†’ Sheetsè¡Œãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ï¼ˆæ›¸ãè¾¼ã¿æ™‚ï¼‰
 */
function convertReservationToRow(reservation: ReservationCore, headerMap: HeaderMapType): RawSheetRow {
  const row: RawSheetRow = new Array(Object.keys(headerMap).length);
  row[headerMap['äºˆç´„ID']] = reservation.reservationId;
  row[headerMap['ç”Ÿå¾’ID']] = reservation.studentId;
  row[headerMap['æ•™å®¤']] = reservation.classroom;
  row[headerMap['æ—¥ä»˜']] = reservation.date;
  row[headerMap['ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹']] = reservation.status;
  // ... ãã®ä»–ã®ãƒãƒƒãƒ”ãƒ³ã‚°
  return row;
}
```

---

### 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£å‹

#### Coreå‹

```typescript
/**
 * ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®çµ±ä¸€ã‚³ã‚¢å‹
 */
interface UserCore {
  studentId: string;
  phone: string;
  realName: string;
  displayName: string;
  nickname?: string;
  email?: string;
  wantsEmail?: boolean;
  wantsScheduleNotification?: boolean;
  notificationDay?: number;
  notificationHour?: number;
  ageGroup?: string;
  gender?: string;
  dominantHand?: string;
  address?: string;
  experience?: string;
  pastWork?: string;
  futureParticipation?: string;
  futureCreations?: string;
}
```

#### DTOå‹

```typescript
/** æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆIDãªã—ï¼‰ */
interface UserRegistrationDto extends Omit<UserCore, 'studentId' | 'displayName'> {
  phone: string; // å¿…é ˆ
  realName: string; // å¿…é ˆ
  trigger?: string; // ç™»éŒ²ç‰¹æœ‰
  firstMessage?: string; // ç™»éŒ²ç‰¹æœ‰
}

/** ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±æ›´æ–°ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆéƒ¨åˆ†æ›´æ–°ï¼‰ */
type UserUpdateDto = Partial<UserCore> & {
  studentId: string; // IDã¯å¿…é ˆ
};

/** APIé€šä¿¡ç”¨ï¼ˆæœ€å°é™ï¼‰ */
interface UserInfoDto {
  studentId: string;
  displayName: string;
  realName: string;
}

/** ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ç”»é¢ç”¨ï¼ˆå…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¡¨ç¤ºï¼‰ */
type UserProfileDto = UserCore;
```

---

### 3. ä¼šè¨ˆé–¢é€£å‹

#### Coreå‹

```typescript
/**
 * ä¼šè¨ˆè©³ç´°ï¼ˆè¨ˆç®—çµæœï¼‰
 */
interface AccountingDetailsCore {
  tuition: {
    items: Array<{ name: string; price: number }>;
    subtotal: number;
  };
  sales: {
    items: Array<{ name: string; price: number }>;
    subtotal: number;
  };
  grandTotal: number;
  paymentMethod: string;
}

/**
 * ä¼šè¨ˆãƒã‚¹ã‚¿ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ 
 */
interface AccountingMasterItemCore {
  ç¨®åˆ¥: string;
  é …ç›®å: string;
  å¯¾è±¡æ•™å®¤: string;
  å˜ä¾¡: number;
  å˜ä½: string;
  å‚™è€ƒ?: string;
}
```

#### DTOå‹

```typescript
/**
 * ä¼šè¨ˆãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ãƒ‡ãƒ¼ã‚¿
 */
interface AccountingFormDto {
  paymentMethod: string;

  // æ™‚é–“ãƒ™ãƒ¼ã‚¹æˆæ¥­æ–™ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
  timeBased?: {
    startTime: string;
    endTime: string;
    breakMinutes: number;
    discountApplied: boolean;
  };

  // æˆæ¥­æ–™é …ç›®ï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹é¸æŠï¼‰
  tuitionItems?: string[];

  // ç‰©è²©ãƒ»ææ–™è²»
  salesItems?: Array<{
    name: string;
    price?: number;
  }>;

  // ææ–™è²»ï¼ˆä½“ç©è¨ˆç®—ç”¨ï¼‰
  materials?: Array<{
    type: string;
    l?: number;
    w?: number;
    h?: number;
  }>;

  // ä½œæ¥­ãƒ¡ãƒ¢
  workInProgress?: string;
}

/**
 * ä¼šè¨ˆè©³ç´°ä¿å­˜ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
 */
interface AccountingSaveDto {
  reservationId: string;
  classroom: string;
  studentId: string;
  userInput: AccountingFormDto;
  updateStatus?: boolean; // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ã€Œå®Œäº†ã€ã«å¤‰æ›´ã™ã‚‹ã‹
}
```

---

## å®Ÿè£…è¨ˆç”»

### Phase 1: Coreå‹å®šç¾©ã®ä½œæˆ âœ…

**æœŸé–“**: 1æ—¥

1. `types/core/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ–°è¦ä½œæˆ
2. ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š
   - `reservation-core.d.ts` - äºˆç´„é–¢é€£ã®Coreå‹
   - `user-core.d.ts` - ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£ã®Coreå‹
   - `accounting-core.d.ts` - ä¼šè¨ˆé–¢é€£ã®Coreå‹
   - `index.d.ts` - çµ±åˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

**æˆæœç‰©**:

- çµ±ä¸€ã•ã‚ŒãŸCoreå‹å®šç¾©
- æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¸ã®å½±éŸ¿ãªã—ï¼ˆä¸¦è¡Œç¨¼åƒï¼‰

---

### Phase 2: DTOå‹å®šç¾©ã®ä½œæˆ ğŸ”„

**æœŸé–“**: 1-2æ—¥

3. `types/dto/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ–°è¦ä½œæˆ
4. ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š
   - `reservation-dto.d.ts` - äºˆç´„æ“ä½œç”¨DTO
   - `user-dto.d.ts` - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œç”¨DTO
   - `accounting-dto.d.ts` - ä¼šè¨ˆæ“ä½œç”¨DTO
   - `index.d.ts` - çµ±åˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

**æˆæœç‰©**:

- æ“ä½œåˆ¥ã«æœ€é©åŒ–ã•ã‚ŒãŸDTOå‹å®šç¾©
- APIé€šä¿¡ãƒ»ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ãƒ»ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã®æ˜ç¢ºãªåˆ†é›¢

---

### Phase 3: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®æ®µéšçš„ç§»è¡Œ ğŸ”„

**æœŸé–“**: 3-5æ—¥

5. **å¤‰æ›é–¢æ•°ã®å®Ÿè£…** (`08_Utilities.js`)
   - `convertRowToReservation()`
   - `convertReservationToRow()`
   - `convertRowToUser()`
   - ãã®ä»–å¤‰æ›é–¢æ•°

6. **äºˆç´„å‡¦ç†ã®ç§»è¡Œ** (`05-2_Backend_Write.js`)
   - äºˆç´„ä½œæˆ: `ReservationCreateDto` â†’ `ReservationCore`
   - äºˆç´„æ›´æ–°: `ReservationUpdateDto` â†’ `ReservationCore`
   - äºˆç´„ã‚­ãƒ£ãƒ³ã‚»ãƒ«: `ReservationCancelDto` â†’ `ReservationCore`

7. **ãƒ¦ãƒ¼ã‚¶ãƒ¼å‡¦ç†ã®ç§»è¡Œ** (`04_Backend_User.js`)
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²: `UserRegistrationDto` â†’ `UserCore`
   - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°: `UserUpdateDto` â†’ `UserCore`

8. **ç©ºãçŠ¶æ³API** (`05-3_Backend_AvailableSlots.js`)
   - äºˆç´„ä¸€è¦§å–å¾—: `ReservationCore[]` â†’ `ReservationApiDto[]`

9. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ ** (`07_CacheManager.js`)
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿å‹ã‚’ `ReservationCore[]` ã«çµ±ä¸€
   - å·®åˆ†æ›´æ–°é–¢æ•°ã®å‹å®šç¾©ã‚’æ›´æ–°

**æˆæœç‰©**:

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å…¨ä½“ãŒçµ±ä¸€å‹ã‚’ä½¿ç”¨
- å‹ã‚­ãƒ£ã‚¹ãƒˆã®å‰Šæ¸›
- å‹å®‰å…¨æ€§ã®å‘ä¸Š

---

### Phase 4: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®æ®µéšçš„ç§»è¡Œ ğŸ¨

**æœŸé–“**: 3-5æ—¥

10. **çŠ¶æ…‹ç®¡ç†ã®ç§»è¡Œ** (`12_WebApp_StateManager.js`)
    - `myReservations: ReservationCore[]`
    - `currentUser: UserCore`
    - `accountingReservation: ReservationCore | null`

11. **äºˆç´„ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ç§»è¡Œ** (`14_WebApp_Handlers_Reservation.js`)
    - äºˆç´„ä½œæˆãƒ•ã‚©ãƒ¼ãƒ : `ReservationCreateDto`
    - äºˆç´„æ›´æ–°ãƒ•ã‚©ãƒ¼ãƒ : `ReservationUpdateDto`
    - äºˆç´„ã‚­ãƒ£ãƒ³ã‚»ãƒ«: `ReservationCancelDto`

12. **èªè¨¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ç§»è¡Œ** (`14_WebApp_Handlers_Auth.js`)
    - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²: `UserRegistrationDto`
    - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†: `UserUpdateDto`

13. **ä¼šè¨ˆç”»é¢ã®ç§»è¡Œ** (`13_WebApp_Views_Accounting.js`)
    - ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›: `AccountingFormDto`
    - ä¿å­˜å‡¦ç†: `AccountingSaveDto`

**æˆæœç‰©**:

- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å…¨ä½“ãŒçµ±ä¸€å‹ã‚’ä½¿ç”¨
- UIã¨ãƒ­ã‚¸ãƒƒã‚¯ã®å‹æ•´åˆæ€§ç¢ºä¿

---

### Phase 5: æ—§å‹å®šç¾©ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— ğŸ§¹

**æœŸé–“**: 1-2æ—¥

14. **éæ¨å¥¨ãƒãƒ¼ã‚¯**
    - æ—§å‹å®šç¾©ã« `@deprecated` ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
    - æ–°ã—ã„å‹ã¸ã®ç§»è¡Œã‚¬ã‚¤ãƒ‰ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰

15. **æ—§å‹å®šç¾©ã®å‰Šé™¤**
    - ç§»è¡Œå®Œäº†å¾Œã€æ—§å‹å®šç¾©ã‚’å‰Šé™¤
    - æœªä½¿ç”¨å‹ã®ãƒã‚§ãƒƒã‚¯: `npx ts-unused-exports`

16. **å“è³ªãƒã‚§ãƒƒã‚¯**
    - å‹ãƒã‚§ãƒƒã‚¯: `npm run check-types`
    - ãƒªãƒ³ãƒˆ: `npm run lint`
    - ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ: `npm run dev:test`

17. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°**
    - `DATA_MODEL.md` ã®å‹å®šç¾©ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ›´æ–°
    - `TYPES_GUIDE.md` æ–°è¦ä½œæˆï¼ˆå‹ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼‰

**æˆæœç‰©**:

- ã‚¯ãƒªãƒ¼ãƒ³ãªå‹ã‚·ã‚¹ãƒ†ãƒ 
- åŒ…æ‹¬çš„ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

---

### ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³

| Phase    | æœŸé–“       | æˆæœç‰©             | å‹•ä½œç¢ºèª         |
| -------- | ---------- | ------------------ | ---------------- |
| Phase 1  | 1æ—¥        | Coreå‹å®šç¾©         | å‹ãƒã‚§ãƒƒã‚¯ã®ã¿   |
| Phase 2  | 1-2æ—¥      | DTOå‹å®šç¾©          | å‹ãƒã‚§ãƒƒã‚¯ã®ã¿   |
| Phase 3  | 3-5æ—¥      | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç§»è¡Œ   | GASãƒ†ã‚¹ãƒˆç’°å¢ƒ    |
| Phase 4  | 3-5æ—¥      | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç§»è¡Œ | WebAppãƒ†ã‚¹ãƒˆ     |
| Phase 5  | 1-2æ—¥      | ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—     | åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ     |
| **åˆè¨ˆ** | **9-15æ—¥** | **çµ±ä¸€å‹ã‚·ã‚¹ãƒ†ãƒ ** | **æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤** |

---

## ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

### âœ… ãƒ¡ãƒªãƒƒãƒˆ

#### 1. å‹å®‰å…¨æ€§ã®åŠ‡çš„å‘ä¸Š

- `any`, `[key: string]: unknown` ã®å®Œå…¨æ’é™¤
- TypeScriptã®å‹æ¨è«–ãŒæ­£å¸¸ã«æ©Ÿèƒ½
- ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã®ã‚¨ãƒ©ãƒ¼æ¤œå‡ºç‡å‘ä¸Š

#### 2. é–‹ç™ºä½“é¨“ã®å‘ä¸Š

- IDEã®è£œå®Œæ©Ÿèƒ½ãŒæ­£ç¢ºã«å‹•ä½œ
- ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã®å½±éŸ¿ç¯„å›²ãŒæ˜ç¢º
- å‹ã‚¨ãƒ©ãƒ¼ã§å•é¡Œç®‡æ‰€ãŒå³åº§ã«åˆ†ã‹ã‚‹

#### 3. ä¿å®ˆæ€§ã®æ”¹å–„

- å‹å®šç¾©ãŒ1ç®‡æ‰€ã«é›†ç´„
- å¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²ãŒé™å®šçš„
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ã®å½¹å‰²

#### 4. ãƒã‚°ã®å‰Šæ¸›

- ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã®ä¸ä¸€è‡´ãŒãªããªã‚‹
- null/undefinedå‡¦ç†ã®çµ±ä¸€
- å‹ã®ä¸æ•´åˆã«ã‚ˆã‚‹ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã®é˜²æ­¢

#### 5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š

- ä¸è¦ãªå‹å¤‰æ›å‡¦ç†ã®å‰Šæ¸›
- ãƒ‡ãƒ¼ã‚¿ã®æµã‚ŒãŒæ˜ç¢ºåŒ–
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã®æœ€é©åŒ–

#### 6. è‡ªå·±æ–‡æ›¸åŒ–

- å‹å®šç¾©è‡ªä½“ãŒAPIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- ã‚³ãƒ¼ãƒ‰ã®æ„å›³ãŒæ˜ç¢º
- æ–°è¦å‚åŠ è€…ã®ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å®¹æ˜“åŒ–

---

### âš ï¸ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒªã‚¹ã‚¯

#### 1. ç§»è¡Œã‚³ã‚¹ãƒˆ

- **å½±éŸ¿ç¯„å›²**: ç´„20-30ãƒ•ã‚¡ã‚¤ãƒ«
- **æ‰€è¦æ™‚é–“**: 9-15æ—¥
- **ãƒ†ã‚¹ãƒˆè² è·**: å…¨æ©Ÿèƒ½ã®å‹•ä½œç¢ºèªãŒå¿…é ˆ

#### 2. ä¸€æ™‚çš„ãªè¤‡é›‘åº¦å¢—åŠ 

- ç§»è¡ŒæœŸé–“ä¸­ã«æ–°æ—§å‹ãŒæ··åœ¨
- é–‹ç™ºè€…ã®æ··ä¹±ã®å¯èƒ½æ€§
- ãƒ‡ãƒãƒƒã‚°ã®é›£æ˜“åº¦ä¸Šæ˜‡

#### 3. å­¦ç¿’ã‚³ã‚¹ãƒˆ

- æ–°ã—ã„å‹ã‚·ã‚¹ãƒ†ãƒ ã®ç†è§£ãŒå¿…è¦
- Coreå‹ã¨DTOå‹ã®ä½¿ã„åˆ†ã‘ãƒ«ãƒ¼ãƒ«
- å¤‰æ›é–¢æ•°ã®ä½¿ç”¨æ–¹æ³•

#### 4. å¾Œæˆ»ã‚Šã®å›°é›£ã•

- ä¸€åº¦ç§»è¡Œã‚’é–‹å§‹ã™ã‚‹ã¨ä¸­æ–­ãŒå›°é›£
- æ®µéšçš„ãªç§»è¡Œè¨ˆç”»ãŒå¿…é ˆ
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥ã®é‡è¦æ€§

---

### ğŸ›¡ï¸ ãƒªã‚¹ã‚¯è»½æ¸›ç­–

#### 1. æ®µéšçš„ç§»è¡Œ

- Phaseå˜ä½ã§å®Œçµã•ã›ã‚‹
- å„Phaseçµ‚äº†æ™‚ã«å‹•ä½œç¢ºèª
- å•é¡Œç™ºç”Ÿæ™‚ã¯ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

#### 2. æ—§å‹ã®ä¸€æ™‚çš„ç¶­æŒ

- `@deprecated` ã§ãƒãƒ¼ã‚¯
- ä¸€å®šæœŸé–“ã¯æ—§å‹ã‚‚ä¸¦è¡Œç¨¼åƒ
- æ®µéšçš„ãªå‰Šé™¤

#### 3. åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ

- å„Phaseå®Œäº†æ™‚ã«æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
- ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã®ååˆ†ãªæ¤œè¨¼
- æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤å‰ã®æœ€çµ‚ç¢ºèª

#### 4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå……å®Ÿ

- å‹ã‚·ã‚¹ãƒ†ãƒ ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ä½œæˆ
- ç§»è¡Œæ‰‹é †ã®è©³ç´°è¨˜éŒ²
- ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### 5. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

- Git tagã§å„Phaseå®Œäº†æ™‚ç‚¹ã‚’è¨˜éŒ²
- `git revert` å¯èƒ½ãªçŠ¶æ…‹ç¶­æŒ
- ãƒ†ã‚¹ãƒˆãƒ–ãƒ©ãƒ³ãƒã§ã®å…ˆè¡Œå®Ÿæ–½

---

## AIé§†å‹•é–‹ç™ºã«ãŠã‘ã‚‹å‹ç®¡ç†

### AIé§†å‹•é–‹ç™ºã®ç‰¹æ€§

#### å‹å®šç¾©ãŒæ··ä¹±ã—ã‚„ã™ã„ç†ç”±

1. **ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåˆ¶ç´„**
   - AIã¯éå»ã®å…¨ã‚³ãƒ¼ãƒ‰ã‚’å¸¸ã«æŠŠæ¡ã—ã¦ã„ãªã„
   - æ—¢å­˜ã®å‹ã‚’è¦‹è½ã¨ã—ã¦æ–°è¦ä½œæˆã—ã¦ã—ã¾ã†

2. **å±€æ‰€æœ€é©åŒ–**
   - ã€Œã“ã®é–¢æ•°ã ã‘å‹•ã‘ã°è‰¯ã„ã€ã¨ã„ã†çŸ­æœŸçš„è¦–ç‚¹
   - ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ä¸€è²«æ€§ã‚’è¦‹å¤±ã†

3. **å¿œæ€¥å‡¦ç½®ã®ç©ã¿é‡ã­**
   - å‹ã‚¨ãƒ©ãƒ¼ã‚’`any`ã§ã€Œã¨ã‚Šã‚ãˆãšæ¶ˆã™ã€
   - é•·æœŸçš„ãªå‹å®‰å…¨æ€§ã‚ˆã‚ŠçŸ­æœŸçš„ãªå‹•ä½œã‚’å„ªå…ˆ

4. **å‘½åã®æºã‚Œ**
   - åŒã˜æ¦‚å¿µã«å¯¾ã™ã‚‹ç•°ãªã‚‹å‘½åãƒ‘ã‚¿ãƒ¼ãƒ³
   - `UserInfo` / `UserData` / `UserCore` ã®æ··åœ¨

#### ç™ºç”Ÿé€Ÿåº¦ã®æ¯”è¼ƒ

| é–‹ç™ºå½¢æ…‹       | æ··ä¹±ã®ç™ºç”Ÿé€Ÿåº¦             | ä¸»ãªåŸå›                            | æ°—ã¥ãã‚„ã™ã•           |
| -------------- | -------------------------- | ---------------------------------- | ---------------------- |
| **AIé§†å‹•**     | **éå¸¸ã«é€Ÿã„**ï¼ˆæ•°é€±é–“ï¼‰   | ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåˆ¶ç´„ãƒ»å±€æ‰€æœ€é©åŒ–       | æ°—ã¥ãã«ãã„           |
| **äººé–“ãƒãƒ¼ãƒ ** | æ¯”è¼ƒçš„ç·©ã‚„ã‹ï¼ˆæ•°ãƒ¶æœˆã€œå¹´ï¼‰ | æ™‚é–“çš„åˆ¶ç´„ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³ | ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æ°—ã¥ã |

---

### å¯¾ç­–ï¼šå‹ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ã®ç¶­æŒ

#### 1. å®šæœŸçš„ãªã€Œå‹ã‚·ã‚¹ãƒ†ãƒ å¥åº·è¨ºæ–­ã€

**å®Ÿæ–½é »åº¦**: æœˆ1å›ã¾ãŸã¯å¤§ããªæ©Ÿèƒ½è¿½åŠ å¾Œ

```bash
# å‹å®šç¾©ã®é‡è¤‡ã‚’æ¤œå‡º
echo "=== äºˆç´„é–¢é€£å‹ ==="
grep -r "interface.*Reservation" types/ | wc -l
grep -r "type.*Reservation" types/ | wc -l

echo "=== ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£å‹ ==="
grep -r "interface.*User" types/ | wc -l
grep -r "type.*User" types/ | wc -l

echo "=== ä¼šè¨ˆé–¢é€£å‹ ==="
grep -r "interface.*Accounting" types/ | wc -l
grep -r "type.*Accounting" types/ | wc -l

# å±é™ºãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º
echo "=== å±é™ºãªå‹å®šç¾© ==="
grep -r ": any" types/
grep -r "\[key: string\]: unknown" types/
```

**é–¾å€¤è¨­å®š**:

- åŒã˜æ¦‚å¿µã®å‹ãŒ**3ã¤ä»¥ä¸Š**: è¦æ•´ç†
- `any` ã®ä½¿ç”¨ç®‡æ‰€ãŒ**5ç®‡æ‰€ä»¥ä¸Š**: è¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

---

#### 2. å‹å®šç¾©ã®ã€Œæ†²æ³•ã€ã‚’ä½œæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `TYPES_GUIDE.md`

```markdown
# å‹å®šç¾©ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

## å‘½åè¦å‰‡

### Coreå‹

- å½¢å¼: `XXXCore`
- ä¾‹: `ReservationCore`, `UserCore`, `AccountingDetailsCore`
- ç”¨é€”: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã§å…±é€šä½¿ç”¨

### DTOå‹

- å½¢å¼: `XXXDto` ã¾ãŸã¯ `XXXXXXDto`
- ä¾‹: `ReservationCreateDto`, `UserUpdateDto`
- ç”¨é€”: ç‰¹å®šã®æ“ä½œã«ç‰¹åŒ–

### ç¦æ­¢äº‹é …

- `any` ã®ä½¿ç”¨ï¼ˆä¾‹å¤–: ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£APIé€£æºæ™‚ã®ã¿ï¼‰
- `[key: string]: unknown` ã®ä½¿ç”¨ï¼ˆç‰¹å®šã®å‹•çš„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä»¥å¤–ï¼‰
- åŒã˜æ¦‚å¿µã«å¯¾ã™ã‚‹è¤‡æ•°ã®å‹å®šç¾©

## å‹ã®é…ç½®

- **Coreå‹**: `types/core/`
- **DTOå‹**: `types/dto/`
- **ç’°å¢ƒå›ºæœ‰å‹**: `types/gas-environment.d.ts`, `types/html-environment.d.ts`

## æ–°ã—ã„å‹ã‚’ä½œã‚‹å‰ã®ç¢ºèª

1. `grep -r "interface XXX" types/` ã§æ—¢å­˜å‹ã‚’æ¤œç´¢
2. æ—¢å­˜ã®å‹ã§è¡¨ç¾ã§ãã‚‹å ´åˆã¯å†åˆ©ç”¨
3. ç¶™æ‰¿ãƒ»æ‹¡å¼µã§å¯¾å¿œã§ããªã„ã‹æ¤œè¨
4. æ–°è¦ä½œæˆãŒå¿…è¦ãªå ´åˆã®ã¿ä½œæˆ

## ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] é‡è¤‡ã™ã‚‹å‹å®šç¾©ãŒãªã„ã‹
- [ ] `any` ã‚„ `unknown` ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ã‹
- [ ] å‘½åè¦å‰‡ã«å¾“ã£ã¦ã„ã‚‹ã‹
- [ ] é©åˆ‡ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã‹
```

---

#### 3. AIã¸ã®æ˜ç¤ºçš„ãªæŒ‡ç¤º

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæŒ‡ç¤ºï¼ˆ`CLAUDE.md`ï¼‰ã«è¿½åŠ **:

````markdown
## å‹å®šç¾©ã®çµ¶å¯¾ãƒ«ãƒ¼ãƒ«

ğŸš¨ **æ–°ã—ã„å‹ã‚’ä½œã‚‹å‰ã«å¿…ãšç¢ºèª**:

1. **æ—¢å­˜å‹ã®æ¤œç´¢**
   ```bash
   grep -r "interface XXX" types/
   grep -r "type XXX" types/
   ```
````

2. **å†åˆ©ç”¨ã®æ¤œè¨**
   - æ—¢å­˜ã®å‹ã§è¡¨ç¾ã§ãã‚‹å ´åˆã¯å†åˆ©ç”¨
   - ç¶™æ‰¿ãƒ»æ‹¡å¼µã§å¯¾å¿œ: `extends`, `Pick`, `Omit`, `Partial`

3. **å‘½åè¦å‰‡ã®éµå®ˆ**
   - Coreå‹: `XXXCore`
   - DTOå‹: `XXXDto`

ğŸš¨ **ç¦æ­¢äº‹é …**:

- âŒ `any` ã®ä½¿ç”¨ï¼ˆä¾‹å¤–: ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£APIé€£æºã®ã¿ï¼‰
- âŒ `[key: string]: unknown` ã®ä½¿ç”¨ï¼ˆç‰¹å®šã®å‹•çš„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä»¥å¤–ï¼‰
- âŒ åŒã˜æ¦‚å¿µã«å¯¾ã™ã‚‹è¤‡æ•°ã®å‹å®šç¾©
- âŒ å‹ã®é‡è¤‡ä½œæˆ

ğŸš¨ **å‹ä½œæˆã®ãƒ•ãƒ­ãƒ¼**:

```
æ—¢å­˜å‹ã‚’æ¤œç´¢
  â†“
å­˜åœ¨ã™ã‚‹ï¼Ÿ
  â”œâ”€ Yes â†’ å†åˆ©ç”¨ã¾ãŸã¯ç¶™æ‰¿
  â””â”€ No  â†’ å‘½åè¦å‰‡ã«å¾“ã£ã¦æ–°è¦ä½œæˆ
            â†“
         é©åˆ‡ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
            â†“
         index.d.ts ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¿½åŠ 
```

````

---

#### 4. å‹å®šç¾©ã®ã€Œå¤§æƒé™¤ã€ã‚’å®šæœŸå®Ÿè¡Œ

**ã‚¿ã‚¤ãƒŸãƒ³ã‚°**:
- ãƒ¡ã‚¸ãƒ£ãƒ¼æ©Ÿèƒ½å®Œæˆå¾Œ
- ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å¤‰æ›´å¾Œ
- 3ãƒ¶æœˆã”ã¨

**ä½œæ¥­å†…å®¹**:

1. **é‡è¤‡å‹ã®çµ±åˆ**
   ```bash
   # é‡è¤‡æ¤œå‡º
   grep -r "interface Reservation" types/ | sort
````

2. **`any` / `unknown` ã®æ’é™¤**

   ```bash
   # å±é™ºç®‡æ‰€ã®ç‰¹å®š
   grep -rn ": any" src/
   grep -rn "\[key: string\]: unknown" src/
   ```

3. **æœªä½¿ç”¨å‹ã®å‰Šé™¤**

   ```bash
   # æœªä½¿ç”¨ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã®æ¤œå‡º
   npx ts-unused-exports tsconfig.json
   ```

4. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°**
   - `TYPES_GUIDE.md` ã®è¦‹ç›´ã—
   - å‹å®šç¾©ã®å¤‰æ›´å±¥æ­´ã‚’è¨˜éŒ²

---

### AIé§†å‹•é–‹ç™ºã®åˆ©ç‚¹

**å‹ã‚·ã‚¹ãƒ†ãƒ æ•´ç†ã«ãŠã‘ã‚‹å¼·ã¿**:

1. **é«˜é€Ÿãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**
   - äººé–“ãªã‚‰æ•°æ—¥ã‹ã‹ã‚‹ä½œæ¥­ã‚’æ•°æ™‚é–“ã§å®Œäº†
   - ä¸€è²«æ€§ã®ã‚ã‚‹å¤‰æ›´ã‚’ä¸€åº¦ã«é©ç”¨

2. **ç¶²ç¾…çš„ãªå½±éŸ¿ç¯„å›²åˆ†æ**
   - å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¬æ™‚ã«ã‚¹ã‚­ãƒ£ãƒ³
   - å¤‰æ›´ã®å½±éŸ¿ã‚’å³åº§ã«æ¤œå‡º

3. **å‹ã‚·ã‚¹ãƒ†ãƒ ã¨ã®ç›¸æ€§**
   - æ­£è§£ãŒæ˜ç¢ºãªé ˜åŸŸã§ã¯AIã¯éå¸¸ã«å¼·åŠ›
   - å‹å®šç¾©ã®é‡è¤‡ãƒ»ä¸æ•´åˆã‚’ç¢ºå®Ÿã«æ¤œå‡º

4. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ**
   - å‹å®šç¾©ã‹ã‚‰è‡ªå‹•çš„ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ
   - ä½¿ç”¨ä¾‹ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æç¤º

---

## ä»Šå¾Œã®é‹ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### å‹å®šç¾©ã®ä½œæˆãƒ«ãƒ¼ãƒ«

#### 1. æ–°ã—ã„å‹ã‚’ä½œã‚‹å‰ã®ç¢ºèªæ‰‹é †

```bash
# Step 1: æ—¢å­˜å‹ã®æ¤œç´¢
grep -r "interface MyNewType" types/
grep -r "type MyNewType" types/

# Step 2: é¡ä¼¼ã®å‹ã‚’æ¢ã™
grep -r "interface.*Core" types/core/
grep -r "interface.*Dto" types/dto/

# Step 3: å†åˆ©ç”¨ãƒ»ç¶™æ‰¿ã®æ¤œè¨
# æ—¢å­˜å‹ã§è¡¨ç¾ã§ããªã„ã‹ç¢ºèª
```

#### 2. å‹ã®å‘½åè¦å‰‡

| ç¨®é¡          | å‘½åãƒ‘ã‚¿ãƒ¼ãƒ³   | ä¾‹                      | ç”¨é€”                 |
| ------------- | -------------- | ----------------------- | -------------------- |
| Coreå‹        | `XXXCore`      | `ReservationCore`       | ã‚¢ãƒ—ãƒªå…¨ä½“ã§å…±é€šä½¿ç”¨ |
| DTOå‹ï¼ˆä½œæˆï¼‰ | `XXXCreateDto` | `ReservationCreateDto`  | ä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ       |
| DTOå‹ï¼ˆæ›´æ–°ï¼‰ | `XXXUpdateDto` | `ReservationUpdateDto`  | æ›´æ–°ãƒªã‚¯ã‚¨ã‚¹ãƒˆ       |
| DTOå‹ï¼ˆAPIï¼‰  | `XXXApiDto`    | `ReservationApiDto`     | APIå¿œç­”              |
| åˆ—æŒ™å‹        | `XXXEnum`      | `ReservationStatusEnum` | å®šæ•°ã‚»ãƒƒãƒˆ           |

#### 3. å‹ã®é…ç½®ãƒ«ãƒ¼ãƒ«

```
types/
â”œâ”€â”€ core/           # Coreå‹ï¼ˆå…±é€šä½¿ç”¨ï¼‰
â”œâ”€â”€ dto/            # DTOå‹ï¼ˆæ“ä½œåˆ¥ï¼‰
â”œâ”€â”€ enums/          # åˆ—æŒ™å‹ï¼ˆå°†æ¥çš„ã«è¿½åŠ ï¼‰
â””â”€â”€ legacy/         # æ—§å‹å®šç¾©ï¼ˆéæ¨å¥¨ã€æ®µéšçš„å‰Šé™¤ï¼‰
```

---

### å‹å®‰å…¨æ€§ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

#### ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ã®ç¢ºèªé …ç›®

- [ ] **é‡è¤‡ãƒã‚§ãƒƒã‚¯**: é¡ä¼¼ã®å‹å®šç¾©ãŒæ—¢ã«å­˜åœ¨ã—ãªã„ã‹
- [ ] **å‘½åè¦å‰‡**: Coreå‹ã¯`XXXCore`, DTOå‹ã¯`XXXDto`ã«å¾“ã£ã¦ã„ã‚‹ã‹
- [ ] **é…ç½®**: é©åˆ‡ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] **å‹å®‰å…¨æ€§**: `any`, `unknown`ã‚’ä¸é©åˆ‡ã«ä½¿ç”¨ã—ã¦ã„ãªã„ã‹
- [ ] **ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**: `index.d.ts`ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: JSDocã‚³ãƒ¡ãƒ³ãƒˆãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‹

#### è‡ªå‹•ãƒã‚§ãƒƒã‚¯

```bash
# å‹ãƒã‚§ãƒƒã‚¯
npm run check-types

# æœªä½¿ç”¨å‹ã®æ¤œå‡º
npx ts-unused-exports tsconfig.json

# å±é™ºãªãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¤œå‡º
grep -r ": any" src/
grep -r "\[key: string\]: unknown" src/
```

---

### å‹ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

#### æœˆæ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆæ¨å¥¨ï¼‰

**ç¬¬1é€±: å‹å®šç¾©ã®æ£šå¸ã—**

```bash
# é‡è¤‡å‹ã®æ¤œå‡º
./scripts/find-duplicate-types.sh

# æœªä½¿ç”¨å‹ã®æ¤œå‡º
npx ts-unused-exports tsconfig.json
```

**ç¬¬2é€±: å±é™ºç®‡æ‰€ã®ç‰¹å®š**

```bash
# any/unknownã®ä½¿ç”¨ç®‡æ‰€
grep -rn ": any" src/ > any-usage.txt
grep -rn "\[key: string\]: unknown" src/ > unknown-usage.txt
```

**ç¬¬3é€±: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**

- é‡è¤‡å‹ã®çµ±åˆ
- `any`/`unknown`ã®æ’é™¤
- æœªä½¿ç”¨å‹ã®å‰Šé™¤

**ç¬¬4é€±: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°**

- `TYPES_GUIDE.md` ã®è¦‹ç›´ã—
- å‹å®šç¾©ã®å¤‰æ›´å±¥æ­´ã‚’è¨˜éŒ²

---

#### å››åŠæœŸãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆå¿…é ˆï¼‰

1. **å‹ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®è¦‹ç›´ã—**
   - æ–°ã—ã„å‹ã‚«ãƒ†ã‚´ãƒªã®å¿…è¦æ€§
   - å‘½åè¦å‰‡ã®è¦‹ç›´ã—
   - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®æœ€é©åŒ–

2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ**
   - å‹ãƒã‚§ãƒƒã‚¯æ™‚é–“ã®æ¸¬å®š
   - ãƒ“ãƒ«ãƒ‰æ™‚é–“ã¸ã®å½±éŸ¿
   - æœ€é©åŒ–ã®ä½™åœ°

3. **æ•™è‚²ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**
   - å‹ã‚·ã‚¹ãƒ†ãƒ ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ã®æ›´æ–°
   - ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹é›†ã®ä½œæˆ
   - ãƒãƒ¼ãƒ å†…ã®çŸ¥è­˜å…±æœ‰

---

### ç·Šæ€¥æ™‚ã®å¯¾å¿œ

#### å‹ã‚¨ãƒ©ãƒ¼ãŒå¤§é‡ç™ºç”Ÿã—ãŸå ´åˆ

1. **åŸå› ã®ç‰¹å®š**

   ```bash
   npm run check-types 2>&1 | tee type-errors.log
   ```

2. **å½±éŸ¿ç¯„å›²ã®åˆ†æ**
   - ã‚¨ãƒ©ãƒ¼ãŒé›†ä¸­ã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«/å‹ã‚’ç‰¹å®š
   - æœ€è¿‘ã®å¤‰æ›´å±¥æ­´ã‚’ç¢ºèª

3. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯åˆ¤æ–­**
   - ã‚¨ãƒ©ãƒ¼æ•°ãŒ50ä»¶ä»¥ä¸Š: ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’æ¤œè¨
   - ç‰¹å®šã®å‹å¤‰æ›´ãŒåŸå› : ãã®å¤‰æ›´ã®ã¿revert

4. **æ®µéšçš„ä¿®æ­£**
   - å„ªå…ˆåº¦ã®é«˜ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ä¿®æ­£
   - å„ä¿®æ­£å¾Œã«å‹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
   - å‹•ä½œç¢ºèªã‚’ä¸¦è¡Œå®Ÿæ–½

---

## å‚è€ƒè³‡æ–™

### é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [DATA_MODEL.md](DATA_MODEL.md) - ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆæ›¸
- [JS_TO_HTML_ARCHITECTURE.md](JS_TO_HTML_ARCHITECTURE.md) - ãƒ“ãƒ«ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- `TYPES_GUIDE.md` - å‹å®šç¾©ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆæœ¬çµ±ä¸€å¾Œã«ä½œæˆï¼‰

### TypeScriptå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Utility Types](https://www.typescriptlang.org/docs/handbook/utility-types.html) - `Pick`, `Omit`, `Partial`ãªã©
- [Type Inference](https://www.typescriptlang.org/docs/handbook/type-inference.html) - å‹æ¨è«–
- [Advanced Types](https://www.typescriptlang.org/docs/handbook/2/types-from-types.html) - é«˜åº¦ãªå‹æ“ä½œ

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

- [DDD (Domain-Driven Design)](https://martinfowler.com/bliki/DomainDrivenDesign.html) - ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆ
- [DTO Pattern](https://martinfowler.com/eaaCatalog/dataTransferObject.html) - ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
- [TypeScript Deep Dive](https://basarat.gitbook.io/typescript/) - TypeScriptè©³è§£

---

## å¤‰æ›´å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜       | å¤‰æ›´å†…å®¹ | ä½œæˆè€…      |
| ---------- | ---------- | -------- | ----------- |
| 1.0        | 2025-10-03 | åˆç‰ˆä½œæˆ | Claude Code |

---

## ã¾ã¨ã‚

### ç¾çŠ¶ã®å•é¡Œ

- **äºˆç´„å‹**: 5ç¨®é¡ã®é‡è¤‡å‹ãŒå­˜åœ¨
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼å‹**: 5ç¨®é¡ä»¥ä¸Šã®é‡è¤‡å‹ãŒå­˜åœ¨
- **ä¼šè¨ˆå‹**: 5ç¨®é¡ä»¥ä¸Šã®é‡è¤‡å‹ãŒå­˜åœ¨
- **å‹å®‰å…¨æ€§**: `any`, `[key: string]: unknown` ã®ä¹±ç”¨

### çµ±ä¸€å¾Œã®ãƒ¡ãƒªãƒƒãƒˆ

- âœ… å‹å®‰å…¨æ€§ã®åŠ‡çš„å‘ä¸Š
- âœ… é–‹ç™ºä½“é¨“ã®æ”¹å–„ï¼ˆIDEè£œå®Œã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®¹æ˜“æ€§ï¼‰
- âœ… ä¿å®ˆæ€§ã®å‘ä¸Šï¼ˆå‹å®šç¾©ã®é›†ç´„ã€å¤‰æ›´å®¹æ˜“æ€§ï¼‰
- âœ… ãƒã‚°ã®å‰Šæ¸›ï¼ˆå‹ã®ä¸æ•´åˆã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ã®é˜²æ­¢ï¼‰
- âœ… è‡ªå·±æ–‡æ›¸åŒ–ï¼ˆå‹å®šç¾©ãŒAPIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰

### å®Ÿè£…æœŸé–“

**åˆè¨ˆ: 9-15æ—¥**

- Phase 1-2: å‹å®šç¾©ä½œæˆï¼ˆ2-3æ—¥ï¼‰
- Phase 3: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç§»è¡Œï¼ˆ3-5æ—¥ï¼‰
- Phase 4: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç§»è¡Œï¼ˆ3-5æ—¥ï¼‰
- Phase 5: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆ1-2æ—¥ï¼‰

### æ¨å¥¨åˆ¤æ–­

**å¼·ãæ¨å¥¨** - ä»¥ä¸‹ã®ç†ç”±ã‹ã‚‰ã€ä»ŠãŒæœ€é©ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼š

1. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«çµ±åˆãŒå®Œäº†ã—ã¦ã„ã‚‹
2. å‹ã®æ··ä¹±ãŒè‡¨ç•Œç‚¹ã«é”ã—ã¦ã„ã‚‹
3. é•·æœŸçš„ãªåˆ©ç›Šï¼ˆé–‹ç™ºé€Ÿåº¦å‘ä¸Šã€ãƒã‚°å‰Šæ¸›ï¼‰ãŒå¤§ãã„
4. AIé§†å‹•é–‹ç™ºã«ã‚ˆã‚Šé«˜é€Ÿãªå®Ÿè£…ãŒå¯èƒ½

---

## âœ… å®Ÿè£…å®Œäº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

### Phase 1-2: å‹å®šç¾©ã®ä½œæˆ âœ… (2025-10-03 å®Œäº†)

- âœ… Coreå‹å®šç¾©ï¼ˆtypes/core/ï¼‰
  - reservation-core.d.ts
  - user-core.d.ts
  - accounting-core.d.ts
- âœ… DTOå‹å®šç¾©ï¼ˆtypes/dto/ï¼‰
  - reservation-dto.d.ts
  - user-dto.d.ts
  - accounting-dto.d.ts

### Phase 3: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®æ®µéšçš„ç§»è¡Œ âœ… (2025-10-03 å®Œäº†)

- âœ… (1/4) å¤‰æ›é–¢æ•°ã®å®Ÿè£…ï¼ˆ08_Utilities.jsï¼‰
  - convertRowToReservation() / convertReservationToRow()
  - convertRowToUser() / convertUserToRow()
- âœ… (2/4) äºˆç´„å‡¦ç†ã®å‹çµ±ä¸€ï¼ˆ05-2_Backend_Write.js v3.0ï¼‰
  - makeReservation() â†’ ReservationCreateDto
  - updateReservationDetails() â†’ ReservationUpdateDto
  - cancelReservation() â†’ ReservationCancelDto
- âœ… (3/4) ãƒ¦ãƒ¼ã‚¶ãƒ¼å‡¦ç†ã®å‹çµ±ä¸€ï¼ˆ04_Backend_User.js v4.0ï¼‰
  - registerNewUser() â†’ UserRegistrationDto
  - updateUserProfile() â†’ UserUpdateDto
- âœ… (4/4) ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ ã®æº–å‚™ï¼ˆ07_CacheManager.js v6.0ï¼‰
  - å‹å‚ç…§ã®è¿½åŠ ã€å°†æ¥ã® ReservationCore[] ç§»è¡Œæº–å‚™

### Phase 4: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®æ®µéšçš„ç§»è¡Œ â­ï¸ (ã‚¹ã‚­ãƒƒãƒ—)

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯æ—¢å­˜ã®å‹å®šç¾©ã‚’ç¶™ç¶šä½¿ç”¨ã€‚å¿…è¦ã«å¿œã˜ã¦æ®µéšçš„ã«ç§»è¡Œå¯èƒ½ã€‚

### Phase 5: æ—§å‹å®šç¾©ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— âœ… (2025-10-03 å®Œäº†)

- âœ… @deprecated ãƒãƒ¼ã‚¯ã®è¿½åŠ ï¼ˆapi-types.d.tsï¼‰
  - ReservationInfo â†’ ReservationCore
  - CancelReservationInfo â†’ ReservationCancelDto
  - NewUserRegistration â†’ UserRegistrationDto
  - UserProfileUpdate â†’ UserUpdateDto

### Phase 6: å®šæ•°åã¨ã‚·ãƒ¼ãƒˆåã®çµ±ä¸€ âœ… (2025-10-03 å®Œäº†)

#### èƒŒæ™¯ï¼šAIé§†å‹•é–‹ç™ºã§ã®ã€Œã‚ã‚‹ã‚ã‚‹ã€å•é¡Œã®ç™ºç”Ÿ

å‹ã‚·ã‚¹ãƒ†ãƒ çµ±ä¸€ã®å®Ÿè£…ä¸­ã«ã€**AIãŒæ—¢å­˜ã®å®šæ•°ã‚’ç¢ºèªã›ãšã«æ–°ã—ã„å®šæ•°åã‚’ä½¿ç”¨**ã™ã‚‹å•é¡ŒãŒç™ºç”Ÿã€‚
å¤‰æ›é–¢æ•°å®Ÿè£…æ™‚ã«æ—¢å­˜ã® `CONSTANTS.HEADERS.ROSTER` å®šæ•°åã‚’è¦‹ãšã«ã€æ–°ã—ã„åå‰ã§å®Ÿè£…ã—ã¦ã—ã¾ã£ãŸã€‚

**ã“ã‚Œã¯ã¾ã•ã«ã€ŒAIé§†å‹•é–‹ç™ºã‚ã‚‹ã‚ã‚‹ã€ã®å®Ÿä¾‹**:
- æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®ç¢ºèªä¸è¶³
- å±€æ‰€çš„ãªå®Ÿè£…ã«ã‚ˆã‚‹å‘½åã®æºã‚Œ
- çµæœã¨ã—ã¦å®šæ•°åãŒå¢—æ®–

#### å®Ÿæ–½ã—ãŸä¿®æ­£

**1. CONSTANTS.HEADERS.ROSTER ã®å®šæ•°åçµ±ä¸€**

IDEã®ä¸€æ‹¬ç½®æ›æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ã€ä½¿ç”¨ç®‡æ‰€ã‚’çµ±ä¸€ï¼š

| âŒ æ—§åç§°ï¼ˆå‰Šé™¤ï¼‰ | âœ… æ–°åç§°ï¼ˆçµ±ä¸€å¾Œï¼‰ | ã‚·ãƒ¼ãƒˆåˆ—å | æ„å‘³ |
|:---|:---|:---|:---|
| `EMAIL_PREFERENCE` | `WANTS_RESERVATION_EMAIL` | `'äºˆç´„ãƒ¡ãƒ¼ãƒ«å¸Œæœ›'` | äºˆç´„æ™‚ã®ãƒ¡ãƒ¼ãƒ«é€ä¿¡å¸Œæœ› |
| `SCHEDULE_NOTIFICATION_PREFERENCE` | `WANTS_SCHEDULE_INFO` | `'æ—¥ç¨‹é€£çµ¡å¸Œæœ›'` | æ—¥ç¨‹é€šçŸ¥ã®å—ä¿¡å¸Œæœ› |
| `WOODCARVING_EXPERIENCE` | `EXPERIENCE` | `'æœ¨å½«ã‚ŠçµŒé¨“'` | æœ¨å½«ã‚ŠçµŒé¨“ãƒ¬ãƒ™ãƒ« |
| `PAST_CREATIONS` | `PAST_WORK` | `'éå»ã®åˆ¶ä½œç‰©'` | éå»ã®ä½œå“ |
| `FUTURE_PARTICIPATION` | `ATTENDANCE_INTENTION` | `'æƒ³å®šå‚åŠ é »åº¦'` | ä»Šå¾Œã®å‚åŠ é »åº¦ |

**2. UserCoreå‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•´ç†**

é‡è¤‡ãƒ»ä¸è¦ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‰Šé™¤ï¼š

- âŒ å‰Šé™¤: `futureGoal` (å¯¾å¿œã™ã‚‹ã‚·ãƒ¼ãƒˆåˆ—ãŒãªã„é‡è¤‡ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£)
- âœ… ä¿æŒ: `futureParticipation` (ATTENDANCE_INTENTIONã«å¯¾å¿œ)
- âœ… ä¿æŒ: `futureCreations` (FUTURE_CREATIONSã«å¯¾å¿œ)

**3. ã‚·ãƒ¼ãƒˆåã®ç°¡æ½”åŒ–**

å®Ÿéš›ã®Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã‚·ãƒ¼ãƒˆåã‚‚åŒæ™‚ã«å¤‰æ›´ï¼š

| å¤‰æ›´å‰ | å¤‰æ›´å¾Œ | ç†ç”± |
|:---|:---|:---|
| `'çµ±åˆäºˆç´„ã‚·ãƒ¼ãƒˆ'` | `'äºˆç´„è¨˜éŒ²'` | ã‚·ã‚¹ãƒ†ãƒ åã€Œã‚ˆã‚„ããƒ»ãã‚ãã€ã¨æ•´åˆã€ç°¡æ½” |
| `'ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°'` | `'ãƒ­ã‚°'` | ç°¡æ½”ã« |
| `'æ—¥ç¨‹ãƒã‚¹ã‚¿'` | `'æ—¥ç¨‹'` | æ—¥ç¨‹ã¯è¿½åŠ ã•ã‚Œã‚‹ã®ã§ã€Œãƒã‚¹ã‚¿ã€ã¯ä¸é©åˆ‡ |

**4. CONSTANTS.HEADERS.RESERVATIONS ã®æ‹¡å¼µ**

ä¸è¶³ã—ã¦ã„ãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ï¼š

- âœ… è¿½åŠ : `MATERIAL_INFO: 'ææ–™æƒ…å ±'`

#### æ•™è¨“ï¼šAIé–‹ç™ºã§ã®å®šæ•°ç®¡ç†ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

**å•é¡Œ**: AIãŒå¤‰æ›é–¢æ•°å®Ÿè£…æ™‚ã«æ—¢å­˜ã®å®šæ•°åã‚’ç¢ºèªã›ãšã€æ–°ã—ã„åå‰ã‚’ä½¿ç”¨
**èª¤ã£ãŸè§£æ±º**: å®šæ•°å´ã«åˆ¥åè¿½åŠ ï¼ˆä¾‹: `WANTS_EMAIL` ã¨ `EMAIL_PREFERENCE` ä¸¡æ–¹å®šç¾©ï¼‰
**æ­£ã—ã„è§£æ±º**: ä½¿ç”¨ç®‡æ‰€ã‚’**IDEã®ä¸€æ‹¬ç½®æ›**ã§çµ±ä¸€

**é‡è¦ãªåŸå‰‡**:
1. **å®šæ•°ã®ã€Œåˆ¥åã€ã‚’å¢—ã‚„ã™ã“ã¨ã¯æ ¹æœ¬è§£æ±ºã«ãªã‚‰ãªã„**
2. **ä½¿ç”¨ç®‡æ‰€ã‚’æ­£ã—ã„åå‰ã«çµ±ä¸€**ã™ã‚‹ã“ã¨ã§ã€å°†æ¥ã®æ··ä¹±ã‚’é˜²ã
3. **äººé–“ãŒIDEã§ä¸€æ‹¬ç½®æ›**ã—ãŸæ–¹ãŒã€AIãŒå€‹åˆ¥ä¿®æ­£ã™ã‚‹ã‚ˆã‚ŠåŠ¹ç‡çš„ã§ç¢ºå®Ÿ

**å‘½åã®æ–¹é‡**:
- `WANTS_*` ãƒ‘ã‚¿ãƒ¼ãƒ³ã§booleançš„ãªæ„å‘³ã‚’æ˜ç¢ºåŒ–
- æ–‡è„ˆï¼ˆROSTER/RESERVATIONSï¼‰ã§æ„å‘³ãŒé€šã˜ã‚‹ãªã‚‰çŸ­ã
- ã‚³ãƒ¼ãƒ‰å†…ã§ä½¿ã„ã‚„ã™ã„åå‰ â‰  ã‚·ãƒ¼ãƒˆåˆ—åï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ï¼‰

## ğŸ‰ å‹ã‚·ã‚¹ãƒ†ãƒ çµ±ä¸€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†

**å®Ÿè£…æœŸé–“**: 2025-10-03ï¼ˆ1æ—¥ï¼‰ **æœ€çµ‚ã‚³ãƒŸãƒƒãƒˆ**: feature/type-system-unification ãƒ–ãƒ©ãƒ³ãƒ

### é”æˆã•ã‚ŒãŸæˆæœ

1. **å‹ã®é‡è¤‡å‰Šæ¸›**: äºˆç´„5ç¨®é¡ â†’ 1 Core + 4 DTO
2. **å‹å®‰å…¨æ€§ã®å‘ä¸Š**: any/unknown ã®å‰Šæ¸›ã€æ˜ç¤ºçš„ãªå‹å®šç¾©
3. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å‹çµ±ä¸€**: ä¸»è¦é–¢æ•°ã™ã¹ã¦çµ±ä¸€å‹å¯¾å¿œ
4. **å¾Œæ–¹äº’æ›æ€§ç¶­æŒ**: æ—§å½¢å¼ã‚‚å¼•ãç¶šãå‹•ä½œ
5. **æ˜ç¢ºãªç§»è¡Œãƒ‘ã‚¹**: @deprecated ã«ã‚ˆã‚‹æ®µéšçš„ç§»è¡Œã‚µãƒãƒ¼ãƒˆ
6. **å®šæ•°åã®çµ±ä¸€**: CONSTANTS.HEADERS ã®å‘½åè¦å‰‡çµ±ä¸€ã€ã‚·ãƒ¼ãƒˆåã®ç°¡æ½”åŒ–

---

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆä»»æ„ï¼‰**:

- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®æ®µéšçš„ãªå‹ç§»è¡Œ
- æ—§å‹å®šç¾©ã®å®Œå…¨å‰Šé™¤ï¼ˆååˆ†ãªç§»è¡ŒæœŸé–“å¾Œï¼‰
