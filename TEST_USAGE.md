# テストファイルの使い方

このプロジェクトには、**2つの異なるテスト環境**があります。

## 🎯 **テスト環境の分類**

### 🖥️ **ローカルテスト**（`local-tests/`）

- **対象**: フロントエンド機能・UI・レイアウト
- **実行環境**: ブラウザ（Live Server）
- **データ**: モックデータ使用
- **特徴**: GAS接続不要、デザイン確認に最適

### ☁️ **GAS環境テスト**（`src/gas-tests/`）

- **対象**: バックエンド機能・スプレッドシート連携・パフォーマンス
- **実行環境**: Google Apps Scriptエディタ
- **データ**: 実際のスプレッドシートデータ
- **特徴**: 本番環境と同じ条件でのテスト

## 🚀 簡単な実行方法

### ローカルテスト（Live Server使用・推奨）

1. `local-tests/`内のテストファイル（例：`integration_test.html`）を右クリック
2. `Open with Live Server` を選択
3. ブラウザで自動的に開かれます

### メリット

- **ホットリロード**: ファイル編集時に自動でブラウザがリロード
- **ワンクリック起動**: 右クリックですぐにテスト開始
- **リアルタイム確認**: デザインやレイアウトの変更を即座に確認
- **GAS接続不要**: ネットワーク環境に依存しない

### GAS環境テスト（バックエンド機能）

```bash
npm run gas:setup      # テスト環境準備
# GASエディタでテスト実行
npm run gas:cleanup    # 環境クリーンアップ
```

#### 実行可能なテスト関数例

- `runDirectTest()` - 基本機能テスト
- `runRegressionTest()` - 回帰テスト
- `loadTestSpreadsheetManager()` - パフォーマンステスト

## 📁 テストファイル一覧

### ローカルテスト（`local-tests/`）

- `integration_test.html` - WebApp全体の統合テスト
- `test_webapp_functions.html` - WebApp関数のユニットテスト
- `test_loading_messages.html` - ローディングメッセージのUIテスト
- `test_memo_edit.html` - メモ編集機能のテスト
- `test_venue_display.html` - 会場表示機能のテスト
- `test_mobile_ui_improvements.html` - **📱 モバイルUI改善テスト** - 影、タッチフィードバック、アクセシビリティの確認
- `test_real_webapp_ui.html` - **🎯 実アプリUI統合テスト** - 実際のWebAppと完全同一の構造・スタイル・データでのテスト

### GAS環境テスト（`src/gas-tests/`）

#### core/ - 基本機能

- `test-spreadsheet-manager.js` - SpreadsheetManager最適化テスト
- `test-performance.js` - 負荷テスト・パフォーマンス比較
- `test-integration.js` - システム統合テスト

#### features/ - 機能別

- `test-name-population.js` - 名前自動入力機能テスト
- `test-error-handling.js` - エラーハンドリングテスト

#### regression/ - 回帰テスト

- `test-regression.js` - 包括的回帰テスト

## ⚠️ **重要な区別**

### ローカルテストでできること

- ✅ UI/UXの確認
- ✅ レスポンシブデザインの検証
- ✅ JavaScript関数のロジック確認
- ✅ 静的データでの動作確認

### ローカルテストでできないこと

- ❌ 実際のスプレッドシートとの連携
- ❌ Google Apps Script固有の機能
- ❌ 認証・権限関連の処理
- ❌ サーバーサイドのパフォーマンス測定

### GAS環境テストでしかできないこと

- ✅ SpreadsheetApp等のGAS APIテスト
- ✅ 実データでのパフォーマンス測定
- ✅ 権限・認証の動作確認
- ✅ trigger関数の動作確認
- ✅ キャッシュ機能の検証

## 💡 Tips

### 開発フロー推奨

1. **フロントエンド作業**: ローカルテストで UI/UX を確認
2. **バックエンド作業**: GAS環境テストで実機能を検証
3. **統合確認**: 両方のテストで最終確認

### 注意事項

- **ローカルテスト**: Live Serverが起動していない場合は、任意のHTMLファイルを右クリックして `Open with Live Server` を選択
- **GAS環境テスト**: 実際のスプレッドシートを操作するため、テスト用環境での実行を推奨
- **データ保護**: 本番データでのテスト実行時は必ずバックアップを作成

### パフォーマンス確認

- **ローカル**: UIレスポンス速度、レイアウト崩れの確認
- **GAS環境**: サーバー処理時間、API呼び出し回数の測定

## 🆕 **新機能テスト**

### モバイルUI改善テスト (`test_mobile_ui_improvements.html`)

最新のモバイル向けUI改善（影、タッチフィードバック、アクセシビリティ）の効果を確認できる専用テストです。

#### 📱 **テスト内容**

- **ボタンの改善**: 影、ホバー効果、タッチフィードバックの比較
- **カードの改善**: 予約カード、履歴カードの視覚的フィードバック
- **入力フィールド**: フォーカス時の影とアウトライン改善
- **モーダル＆ローディング**: 深度感のある影効果
- **アクセシビリティ**: キーボードフォーカス表示の改善

#### 🔍 **確認方法**

1. `local-tests/test_mobile_ui_improvements.html` を右クリック → `Open with Live Server`
2. **PCの場合**: ブラウザの開発者ツール（F12）でモバイル表示に切り替え
3. **スマートフォンの場合**: 直接アクセスしてタッチで操作確認
4. **改善前後の比較**: 同じページ内で改善前後のUI要素を比較
5. **チェックリスト**: ページ下部のチェックリストで確認項目を記録

#### ⚠️ **特に確認すべきポイント**

- ボタンやカードの影が適切に表示されているか
- タッチ時に視覚的フィードバック（スケール、影の変化）があるか
- 44px以上のタッチターゲットが確保されているか
- キーボードフォーカス時に明確なアウトラインが表示されるか
- タッチデバイスでホバー効果が適切に無効化されているか

### 実アプリUI統合テスト (`test_real_webapp_ui.html`)

実際のWebAppのソースから完全に構造、クラス、ID、スタイルを再現した統合テストです。デザイン変更の仕上がりを即座に確認できます。

#### 🎯 **テスト内容**

- **完全再現**: 実際のWebAppのHTML構造、CSS、JavaScript関数を100%再現
- **リアルデータ**: 実際のアプリで表示されるような予約・履歴データを使用
- **全画面テスト**: ログイン、新規登録、ダッシュボード、予約一覧の各画面を切り替え可能
- **インタラクション**: モーダル、ローディング、ボタンクリックなど実際の操作を再現

#### 🔧 **ソース同期の仕組み**

- **DesignConfig**: `src/11_WebApp_Config.html`から完全コピー
- **Components**: `src/12_WebApp_Core.html`のcreateButton等の関数を再現
- **Views**: `src/13_WebApp_Views.html`のgetLoginView等を再現
- **CSS**: `src/10_WebApp.html`のすべてのスタイルを同期

#### 🚀 **使用方法**

1. `local-tests/test_real_webapp_ui.html` を右クリック → `Open with Live Server`
2. 上部のボタンで各画面を切り替えてテスト
3. モバイル表示でタッチ操作を確認
4. 実際のアプリと同じ見た目・動作であることを確認

#### ✅ **確認できること**

- **デザイン一貫性**: 実際のアプリと完全に同じ見た目
- **レスポンシブ対応**: モバイル・デスクトップでの表示確認
- **コンポーネント動作**: ボタン、カード、入力フィールドの操作感
- **影・アニメーション効果**: モバイル向けUI改善の実際の見た目
- **将来の変更反映**: ソースを更新すれば即座にテストにも反映可能

#### 💡 **開発効率向上**

- **即座の確認**: デザイン変更後、サーバーデプロイなしで仕上がりを確認
- **比較検証**: 変更前後の見た目を並べて比較可能
- **チーム共有**: デザイナー・開発者間での仕上がり確認が容易
